<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizador de Sprites - Fallout 2 CE</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(30, 30, 50, 0.9);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            color: #ff6b6b;
            border-bottom: 3px solid #ff6b6b;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #4ecdc4;
            margin-top: 30px;
            margin-bottom: 15px;
            border-left: 4px solid #4ecdc4;
            padding-left: 15px;
        }
        
        h3 {
            color: #ffe66d;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .info-box {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid #4ecdc4;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .warning-box {
            background: rgba(255, 193, 7, 0.2);
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }
        
        .code-block {
            background: #1e1e1e;
            border: 1px solid #444;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            color: #d4d4d4;
        }
        
        .file-structure {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            color: #c9d1d9;
        }
        
        .file-structure .file {
            color: #79c0ff;
        }
        
        .file-structure .folder {
            color: #a5a5a5;
        }
        
        .file-structure .size {
            color: #ff7b72;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: rgba(0, 0, 0, 0.3);
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #444;
        }
        
        th {
            background: rgba(78, 205, 196, 0.2);
            color: #4ecdc4;
            font-weight: bold;
        }
        
        tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .fid-explanation {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .fid-bit {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #444;
        }
        
        .fid-bit .bit-value {
            color: #ff6b6b;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .fid-bit .bit-desc {
            color: #a5a5a5;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .example {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid #4ecdc4;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .example-title {
            color: #4ecdc4;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        ul, ol {
            margin-left: 30px;
            margin-top: 10px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .highlight {
            background: rgba(255, 235, 59, 0.2);
            padding: 2px 6px;
            border-radius: 3px;
            color: #ffe66d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Visualizador e An√°lise de Sprites - Fallout 2</h1>
        
        <div class="info-box">
            <strong>üìå Objetivo:</strong> Esta p√°gina explica onde est√£o os sprites, como funcionam os formatos .FRM, e como os NPCs s√£o gerados usando o sistema FID (Frame ID).
        </div>

        <h2>üìç ONDE EST√ÉO OS SPRITES?</h2>
        
        <h3>1. Arquivos .DAT (Containers Principais)</h3>
        <div class="file-structure">
<span class="folder">Fallout 2/</span>
‚îú‚îÄ‚îÄ <span class="file">master.dat</span> <span class="size">(333 MB)</span> ‚Üê <span class="highlight">MAIORIA DOS SPRITES AQUI</span>
‚îÇ   ‚îî‚îÄ‚îÄ Cont√©m: sprites de items, scenery, walls, tiles, interface
‚îÇ
‚îú‚îÄ‚îÄ <span class="file">critter.dat</span> <span class="size">(166 MB)</span> ‚Üê <span class="highlight">SPRITES DE NPCs/CRIATURAS</span>
‚îÇ   ‚îî‚îÄ‚îÄ Cont√©m: sprites de personagens, criaturas, anima√ß√µes
‚îÇ
‚îî‚îÄ‚îÄ <span class="folder">data/art/</span>
    ‚îî‚îÄ‚îÄ <span class="file">tiles/grid000.FRM</span> ‚Üê Exemplo de sprite extra√≠do
        </div>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Importante:</strong> A maioria dos sprites est√° <strong>dentro</strong> dos arquivos .DAT, n√£o em pastas. Voc√™ precisa extrair ou usar ferramentas para acess√°-los.
        </div>

        <h3>2. Estrutura de Pastas de Arte</h3>
        <div class="code-block">
art/
‚îú‚îÄ‚îÄ items/      ‚Üí Sprites de itens
‚îú‚îÄ‚îÄ critters/   ‚Üí Sprites de NPCs/criaturas (DENTRO DO critter.dat)
‚îú‚îÄ‚îÄ scenery/    ‚Üí Objetos de cen√°rio
‚îú‚îÄ‚îÄ walls/      ‚Üí Paredes
‚îú‚îÄ‚îÄ tiles/      ‚Üí Tiles do mapa
‚îú‚îÄ‚îÄ misc/       ‚Üí Miscel√¢nea
‚îú‚îÄ‚îÄ intrface/   ‚Üí Interface do jogo
‚îú‚îÄ‚îÄ inven/      ‚Üí Invent√°rio
‚îú‚îÄ‚îÄ heads/      ‚Üí Cabe√ßas de NPCs (para di√°logos)
‚îú‚îÄ‚îÄ backgrnd/   ‚Üí Fundos de di√°logo
‚îî‚îÄ‚îÄ skilldex/   ‚Üí Interface de skills
        </div>

        <h2>üé≠ COMO OS NPCs S√ÉO GERADOS?</h2>
        
        <h3>Sistema FID (Frame ID)</h3>
        <p>Os NPCs s√£o gerados usando um sistema chamado <span class="highlight">FID (Frame ID)</span>, que √© um n√∫mero de 32 bits que codifica todas as informa√ß√µes do sprite:</p>

        <div class="fid-explanation">
            <div class="fid-bit">
                <div class="bit-value">Bits 0-11: frmId</div>
                <div class="bit-desc">ID do arquivo .FRM (0-4095)</div>
            </div>
            <div class="fid-bit">
                <div class="bit-value">Bits 12-15: weaponCode</div>
                <div class="bit-desc">Tipo de arma (0-15)</div>
            </div>
            <div class="fid-bit">
                <div class="bit-value">Bits 16-23: animType</div>
                <div class="bit-desc">Tipo de anima√ß√£o (andar, correr, atacar, etc.)</div>
            </div>
            <div class="fid-bit">
                <div class="bit-value">Bits 24-27: objectType</div>
                <div class="bit-desc">Tipo de objeto (CRITTER, ITEM, etc.)</div>
            </div>
            <div class="fid-bit">
                <div class="bit-value">Bits 28-30: rotation</div>
                <div class="bit-desc">Rota√ß√£o/dire√ß√£o (0-5 = NE, E, SE, SW, W, NW)</div>
            </div>
        </div>

        <div class="code-block">
// Fun√ß√£o que constr√≥i um FID (do c√≥digo-fonte)
int buildFid(int objectType, int frmId, int animType, int weaponCode, int rotation)
{
    return (objectType << 24) | 
           (rotation << 28) | 
           (animType << 16) | 
           (weaponCode << 12) | 
           (frmId & 0xFFF);
}
        </div>

        <h3>Exemplo Pr√°tico: NPC com Arma</h3>
        <div class="example">
            <div class="example-title">Exemplo: NPC masculino tribal com faca andando para o leste</div>
            <ul>
                <li><strong>objectType:</strong> OBJ_TYPE_CRITTER (1)</li>
                <li><strong>frmId:</strong> 1 (hmwarr - homem tribal)</li>
                <li><strong>animType:</strong> ANIM_WALK (1)</li>
                <li><strong>weaponCode:</strong> WEAPON_ANIMATION_KNIFE (1)</li>
                <li><strong>rotation:</strong> ROTATION_E (1 - leste)</li>
            </ul>
            <div class="code-block">
FID = buildFid(1, 1, 1, 1, 1)
    = 0x01010101
            </div>
            <p><strong>Arquivo gerado:</strong> <code>art/critters/hmwarrda.frm</code></p>
            <p>Onde: <code>hmwarr</code> = base do sprite, <code>d</code> = faca, <code>a</code> = andar</p>
        </div>

        <h3>Como o Jogo Constr√≥i o Nome do Arquivo</h3>
        <div class="code-block">
// Do c√≥digo src/art.cc - artBuildFilePath()

Para CRITTERS (objectType = 1):
  Caminho: art/critters/[nome_base][weapon][anim].frm
  
Exemplos:
  - hmwarrda.frm = homem tribal (hmwarr) + faca (d) + andar (a)
  - hfprimca.frm = mulher tribal (hfprim) + sem arma (c) + andar (a)
  - hmjmpsha.frm = homem jumpsuit (hmjmps) + pistola (h) + andar (a)
        </div>

        <h2>üìê FORMATO .FRM (Sprite)</h2>
        
        <h3>Estrutura do Arquivo .FRM</h3>
        <table>
            <tr>
                <th>Campo</th>
                <th>Tipo</th>
                <th>Tamanho</th>
                <th>Descri√ß√£o</th>
            </tr>
            <tr>
                <td>field_0</td>
                <td>int</td>
                <td>4 bytes</td>
                <td>Campo reservado</td>
            </tr>
            <tr>
                <td>framesPerSecond</td>
                <td>short</td>
                <td>2 bytes</td>
                <td>FPS da anima√ß√£o</td>
            </tr>
            <tr>
                <td>actionFrame</td>
                <td>short</td>
                <td>2 bytes</td>
                <td>Frame de a√ß√£o (ex: quando ataca)</td>
            </tr>
            <tr>
                <td>frameCount</td>
                <td>short</td>
                <td>2 bytes</td>
                <td>N√∫mero total de frames</td>
            </tr>
            <tr>
                <td>xOffsets[6]</td>
                <td>short[6]</td>
                <td>12 bytes</td>
                <td>Offsets X para cada dire√ß√£o (0-5)</td>
            </tr>
            <tr>
                <td>yOffsets[6]</td>
                <td>short[6]</td>
                <td>12 bytes</td>
                <td>Offsets Y para cada dire√ß√£o (0-5)</td>
            </tr>
            <tr>
                <td>dataOffsets[6]</td>
                <td>int[6]</td>
                <td>24 bytes</td>
                <td>Offsets dos dados de cada dire√ß√£o</td>
            </tr>
            <tr>
                <td>padding[6]</td>
                <td>int[6]</td>
                <td>24 bytes</td>
                <td>Padding</td>
            </tr>
            <tr>
                <td>dataSize</td>
                <td>int</td>
                <td>4 bytes</td>
                <td>Tamanho total dos dados</td>
            </tr>
            <tr>
                <td>Frames Data</td>
                <td>bytes</td>
                <td>vari√°vel</td>
                <td>Dados dos frames (6 dire√ß√µes √ó N frames)</td>
            </tr>
        </table>

        <h3>Estrutura de Cada Frame</h3>
        <div class="code-block">
struct ArtFrame {
    short width;      // Largura do frame
    short height;     // Altura do frame
    int size;         // Tamanho dos dados do frame
    short x;          // Offset X
    short y;          // Offset Y
    // Depois vem os dados da imagem (pixels indexados na paleta)
};
        </div>

        <h2>üîÑ COMO FUNCIONA O SISTEMA COMPLETO</h2>
        
        <h3>1. Carregamento de Sprites</h3>
        <ol>
            <li>O jogo l√™ a lista de sprites de <code>art/critters/critters.lst</code></li>
            <li>Cada linha cont√©m o nome base do sprite (ex: "hmwarr", "hfprim")</li>
            <li>Quando precisa de um sprite, constr√≥i o FID</li>
            <li>Converte FID em nome de arquivo usando <code>artBuildFilePath()</code></li>
            <li>Carrega o arquivo .FRM do .DAT ou pasta</li>
            <li>Cacheia na mem√≥ria para uso r√°pido</li>
        </ol>

        <h3>2. Renderiza√ß√£o de NPCs</h3>
        <div class="code-block">
// Fluxo de renderiza√ß√£o:
1. NPC tem um FID (ex: 0x01010101)
2. Sistema extrai: objectType, frmId, animType, weaponCode, rotation
3. Constr√≥i nome: "art/critters/hmwarrda.frm"
4. Carrega arquivo .FRM
5. Seleciona frame baseado em:
   - Dire√ß√£o (rotation): 0-5
   - Frame atual da anima√ß√£o
6. Renderiza na tela com offsets corretos
        </div>

        <h3>3. Anima√ß√µes</h3>
        <p>Os NPCs t√™m diferentes tipos de anima√ß√£o:</p>
        <table>
            <tr>
                <th>C√≥digo</th>
                <th>Anim</th>
                <th>Descri√ß√£o</th>
            </tr>
            <tr>
                <td>a</td>
                <td>ANIM_STAND</td>
                <td>Parado</td>
            </tr>
            <tr>
                <td>a</td>
                <td>ANIM_WALK</td>
                <td>Andando</td>
            </tr>
            <tr>
                <td>b</td>
                <td>ANIM_RUN</td>
                <td>Correndo</td>
            </tr>
            <tr>
                <td>c</td>
                <td>ANIM_TAKE_OUT</td>
                <td>Pegando arma</td>
            </tr>
            <tr>
                <td>d</td>
                <td>ANIM_ATTACK</td>
                <td>Atacando</td>
            </tr>
            <tr>
                <td>e</td>
                <td>ANIM_THROW_PUNCH</td>
                <td>Socando</td>
            </tr>
            <tr>
                <td>...</td>
                <td>...</td>
                <td>...</td>
            </tr>
        </table>

        <h2>üõ†Ô∏è COMO EXTRAIR E ANALISAR</h2>
        
        <h3>Ferramentas Necess√°rias</h3>
        <ul>
            <li><strong>dat2</strong> - Extrai arquivos de .DAT</li>
            <li><strong>FRMEdit</strong> - Visualiza e edita .FRM</li>
            <li><strong>Fallout Mod Manager</strong> - Gerencia assets</li>
            <li><strong>Seu pr√≥prio c√≥digo</strong> - Baseado em <code>src/art.cc</code></li>
        </ul>

        <h3>C√≥digo para Analisar .FRM</h3>
        <div class="code-block">
// Baseado em src/art.cc

1. Abrir arquivo .FRM
2. Ler header (estrutura Art)
3. Para cada dire√ß√£o (0-5):
   - Ler offset dos dados
   - Para cada frame:
     - Ler ArtFrame header
     - Ler dados da imagem (width √ó height bytes)
     - Cada byte √© um √≠ndice na paleta (0-255)
4. Renderizar usando paleta do jogo
        </div>

        <h2>üìö C√ìDIGOS-CHAVE PARA ESTUDAR</h2>
        
        <table>
            <tr>
                <th>Arquivo</th>
                <th>Fun√ß√£o</th>
                <th>Descri√ß√£o</th>
            </tr>
            <tr>
                <td>src/art.cc</td>
                <td>artLock()</td>
                <td>Carrega sprite do cache</td>
            </tr>
            <tr>
                <td>src/art.cc</td>
                <td>artBuildFilePath()</td>
                <td>Converte FID em nome de arquivo</td>
            </tr>
            <tr>
                <td>src/art.cc</td>
                <td>artGetFrameData()</td>
                <td>Obt√©m dados de um frame espec√≠fico</td>
            </tr>
            <tr>
                <td>src/art.cc</td>
                <td>buildFid()</td>
                <td>Constr√≥i FID a partir de componentes</td>
            </tr>
            <tr>
                <td>src/db.cc</td>
                <td>dbOpen()</td>
                <td>Abre arquivo .DAT</td>
            </tr>
            <tr>
                <td>src/xfile.cc</td>
                <td>fileOpen()</td>
                <td>Abre arquivo dentro de .DAT</td>
            </tr>
        </table>

        <h2>üí° RESUMO</h2>
        
        <div class="info-box">
            <strong>Onde est√£o:</strong>
            <ul>
                <li>Sprites de NPCs: <code>critter.dat</code> (166 MB)</li>
                <li>Outros sprites: <code>master.dat</code> (333 MB)</li>
                <li>Alguns exemplos: <code>data/art/</code> (poucos arquivos)</li>
            </ul>
        </div>

        <div class="info-box">
            <strong>Como funcionam:</strong>
            <ul>
                <li>Sistema FID codifica: tipo, ID, anima√ß√£o, arma, dire√ß√£o</li>
                <li>FID √© convertido em nome de arquivo .FRM</li>
                <li>Arquivo .FRM cont√©m: header + frames (6 dire√ß√µes)</li>
                <li>Cada frame tem: largura, altura, offsets, dados de pixels</li>
            </ul>
        </div>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Para seu jogo comercial:</strong>
            <ul>
                <li>Estude o formato .FRM</li>
                <li>Crie seu pr√≥prio formato similar</li>
                <li>N√ÉO use os assets do Fallout 2</li>
                <li>Crie seus pr√≥prios sprites</li>
            </ul>
        </div>

        <p style="text-align: center; margin-top: 40px; color: #888;">
            üìñ Documenta√ß√£o baseada na an√°lise do c√≥digo-fonte do Fallout 2 Community Edition
        </p>
    </div>
</body>
</html>

